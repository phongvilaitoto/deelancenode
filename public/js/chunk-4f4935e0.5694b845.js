(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f4935e0"],{"123d":function(t,e,r){(function(e,r){t.exports=r()})(0,(function(){"use strict";var t=function(t,e){"function"===typeof t.scroll?t.scroll({top:t.scrollHeight,behavior:e?"smooth":"instant"}):t.scrollTop=t.scrollHeight},e={bind:function(e,r){var s=!1;e.addEventListener("scroll",(function(t){s=e.scrollTop+e.clientHeight+1<e.scrollHeight})),new MutationObserver((function(a){var i=r.value||{},n=!1===i.always&&s,o=a[a.length-1].addedNodes.length,c=a[a.length-1].removedNodes.length;if(i.scrollonremoved){if(n||1!=o&&1!=c)return}else if(n||1!=o)return;var d=i.smooth,l=!o&&1===c;l&&i.scrollonremoved&&"smoothonremoved"in i&&(d=i.smoothonremoved),t(e,d)})).observe(e,{childList:!0,subtree:!0})},inserted:function(e,r){var s=r.value||{};t(e,s.smooth)}},r={install:function(t,r){t.directive("chat-scroll",e)}};return"undefined"!==typeof window&&window.Vue&&window.Vue.use(r),r}))},3320:function(t,e,r){},"34e0":function(t,e,r){"use strict";var s=r("8a07"),a=r.n(s);a.a},"4b23":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container-fixed mx-auto",style:t.$vuetify.breakpoint.smAndDown?"height: calc(100vh - 168px)":""},[r("v-card",{staticClass:"pa-5",attrs:{outlined:"",tile:"",align:"left"}},[r("b",[t._v("OrderID: "+t._s(t.currentOrder.quotation.orderId))])]),t.loading?r("v-card",{staticClass:"card-body-message body-fixed",attrs:{tile:"",outlined:""}},[r("app-message-loading")],1):r("v-card",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1,smooth:!0,scrollonremoved:!0,smoothonremoved:!1},expression:"{ always: false, smooth: true, scrollonremoved:true, smoothonremoved: false }"}],staticClass:"pa-3 card-body-message body-fixed",attrs:{outlined:"",tile:""}},t._l(t.chat.messages,(function(e,s){return r("div",{key:s},[r("v-lazy",{attrs:{options:{threshold:.5},transition:"fade-transition"}},[e.from!==t.auth._id?r("div",{staticClass:"msg-box receive"},[r("div",{staticClass:"receive-msg"},[r("v-avatar",{attrs:{height:"48"}},[r("v-img",{attrs:{src:t.auth._id===t.currentOrder.freelancerId._id?t.$server+t.currentOrder.employerId.image:t.$server+t.currentOrder.freelancerId.image}})],1),e.image?r("p",[r("v-img",{attrs:{contain:"","max-width":"200",src:t.$server+e.image,"lazy-src":t.$server+e.image},scopedSlots:t._u([{key:"placeholder",fn:function(){return[r("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[r("v-progress-circular",{attrs:{size:"60",indeterminate:"",color:"primary"}})],1)]},proxy:!0}],null,!0)}),r("v-spacer"),r("span",[t._v(t._s(e.message))])],1):e.message?r("p",[t._v(t._s(e.message))]):t._e(),"quotation"===e.type?r("p",[r("v-card",{staticClass:"pa-2"},[r("div",{staticClass:"mx-5 my-5"},[r("b",[t._v(" ໃບສະເໜີລາຄາ ")]),r("br"),r("small",{staticClass:"mb-5"},[t._v(" "+t._s(t.currentOrder.portfolioId.title))]),r("br"),r("b",[t._v("ລາຄາ")]),r("span",{staticClass:"primary--text"},[t._v(" "+t._s(e.orderId.quotation.price.toLocaleString())+" ")]),r("b",[t._v("ກີບ")]),r("app-detail-quotation-modal",{attrs:{auth:t.auth,order:e.orderId,currentOrder:t.currentOrder}})],1)])],1):t._e()],1)]):r("div",{staticClass:"msg-box send"},[r("div",{staticClass:"send-msg"},[e.image?r("p",[r("v-img",{attrs:{contain:"","max-width":"200",src:t.$server+e.image,"lazy-src":t.$server+e.image},on:{click:function(e){t.index=s}},scopedSlots:t._u([{key:"placeholder",fn:function(){return[r("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[r("v-progress-circular",{attrs:{size:"60",indeterminate:"",color:"primary"}})],1)]},proxy:!0}],null,!0)}),r("span",[t._v(t._s(e.message))])],1):e.message?r("p",[t._v(t._s(e.message))]):t._e(),"quotation"===e.type?r("p",[r("v-card",{staticClass:"pa-2"},[r("div",{staticClass:"mx-5 my-5"},[r("b",[t._v(" ໃບສະເໜີລາຄາ ")]),r("br"),r("small",{staticClass:"mb-5"},[t._v(" "+t._s(t.currentOrder.portfolioId.title))]),r("br"),r("b",[t._v("ລາຄາ")]),r("span",{staticClass:"primary--text"},[t._v(" "+t._s(e.orderId.quotation.price.toLocaleString())+" ")]),r("b",[t._v("ກີບ")]),r("app-detail-quotation-modal",{attrs:{auth:t.auth,order:e.orderId,currentOrder:t.currentOrder}})],1)])],1):t._e()]),r("v-spacer")],1)])],1)})),0),t.base64?r("v-card",{attrs:{outlined:"",tile:""}},[r("div",{staticClass:"text-left"},[r("v-img",{staticClass:"ma-1",staticStyle:{border:"1px solid white"},attrs:{contain:"","max-width":"100","max-height":"100",src:t.base64}},[r("v-icon",{staticClass:"error--text mb-2",staticStyle:{cursor:"pointer"},attrs:{size:"30"},on:{click:function(e){t.base64="",t.file=""}}},[t._v(" mdi-cancel")])],1)],1)]):t._e(),r("v-card",{staticClass:"card-input-message",attrs:{outlined:"",tile:""}},[r("v-row",{staticClass:"pa-2",attrs:{"no-gutters":""}},[r("v-col",{staticClass:"text-right",attrs:{cols:"1",xs:"1",sm:"1",md:"1",lg:"1"}},[r("div",{staticClass:"icon"},[r("label",{attrs:{for:"file"}},[r("v-icon",{staticStyle:{"margin-top":"5px"},attrs:{size:t.$vuetify.breakpoint.smAndDown?37:40}},[t._v("mdi-camera")])],1),r("a",{staticClass:"file-input"},[r("input",{attrs:{type:"file",id:"file"},on:{change:t.imgUpload}})])])]),r("v-col",{staticClass:"mx-auto",attrs:{cols:"10",xs:"8",sm:"8",md:"10",lg:"10"}},[r("v-form",{on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[r("v-text-field",{staticClass:"mx-2",attrs:{rounded:"","hide-details":"",solo:"",placeholder:"ພິມຂໍ້ຄວາມ..."},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1)],1),r("v-col",{attrs:{cols:"1",xs:"1",sm:"1",md:"1",lg:"1"}},[r("div",{staticClass:"icon",on:{click:t.sendMessage}},[r("v-icon",{staticStyle:{"margin-top":"3px"},attrs:{size:t.$vuetify.breakpoint.smAndDown?37:40}},[t._v("mdi-send")])],1)])],1)],1),r("v-overlay",{attrs:{value:t.overlay}},[r("v-progress-circular",{attrs:{color:"primary",indeterminate:"",size:"70"}})],1)],1)},a=[],i=(r("a4d3"),r("4de4"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("96cf"),r("89ba")),n=r("2fa7"),o=r("2b0e"),c=r("123d"),d=r.n(c),l=r("2f62"),u=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-row",{attrs:{justify:"center"}},[r("v-dialog",{attrs:{width:"600px"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[r("a",t._g({staticClass:"primary--text ma-3"},s),[r("span",{staticStyle:{"text-decoration":"underline"}},[t._v("ລາຍລະອຽດໃບສະເໜີລາຄາ")])])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[t._v("ລາຍລະອຽດໃບສະເໜີລາຄາ ")])]),r("v-card-text",[r("p",[r("b",[t._v("ວັນທີ່ ")]),t._v(t._s(t.$moment(t.order.quotation.createdAt).format("DD/MM/YY")))]),r("v-divider"),r("br"),r("p",[r("b",[t._v("orderID:")]),t._v(" "+t._s(t.order.quotation.orderId))]),r("v-layout",[r("v-flex",[r("p",[r("b",[t._v("ໃບສະເໜີລາຄາຂອງ")]),t._v(" "+t._s(t.currentOrder.freelancerId._id===t.order.freelancerId?t.currentOrder.freelancerId.username:t.currentOrder.employerId.username)+" ")])]),r("v-flex",[r("p",[r("b",[t._v("ຜູ້ວ່າຈ້າງ")]),t._v(" "+t._s(t.currentOrder.freelancerId._id===t.order.freelancerId?t.currentOrder.employerId.username:t.currentOrder.freelancerId.username)+" ")])])],1),r("v-card",[r("v-card-title",{staticClass:"primary white--text"},[t._v("ລາຍລະອຽດ")]),r("v-card-text",[r("br"),r("p",[t._v(t._s(t.currentOrder.portfolioId.title))]),r("p",[t._v(" - "+t._s(t.currentOrder.quotation.information))])]),r("v-divider"),r("v-card-actions",{staticClass:"white justify-end"},[r("span",{staticClass:"mx-2 my-2"},[r("b",[t._v("ລາຄາ: ")]),t._v(" "+t._s(Number(t.order.quotation.price.toFixed(1)).toLocaleString())+" "),r("b",[t._v("ກີບ ")])])])],1),r("br"),r("b",[t._v("ໃຊ້ເວລາເຮັດ:")]),r("p",[t._v(" "+t._s(t.order.quotation.dayWork)+" ມື້")]),r("b",[t._v("ສິ່ງທີ່ລູກຄ້າຈະໄດ້ຮັບ:")]),r("p",[t._v(t._s(t.order.quotation.receive))]),r("b",[t._v("ໝາຍເຫດ:")]),r("p",[t._v(t._s(t.order.quotation.optional))]),t.auth._id===t.order.employerId?r("div",[r("v-btn",{staticClass:"primary",attrs:{to:{name:"Payment",params:{id:t.order.quotation.orderId}},block:""}},[t._v(" ຊໍາລະເງິນ")]),r("small",[t._v("* ເມື່ອທ່ານຊໍາລະເງິນຜ່ານລະບົບແລ້ວ Freelance ຈະເລີ່ມເຮັດວຽກທັນທີ")])],1):r("div",[r("small",[t._v("* ລໍຖ້າຜູ້ວ່າຈ້າງຊໍາລະເງິນໃຫ້ລະບົບສໍາເລັດ ແລ້ວເລີ່ມເຮັດວຽກໄດ້ທັນທີ")])])],1)],1)],1)],1)},v=[],p={props:["auth","order","currentOrder"],data:function(){return{dialog:!1}}},m=p,h=r("2877"),f=r("6544"),g=r.n(f),b=r("8336"),_=r("b0af"),y=r("99d9"),O=r("169a"),x=r("ce7e"),w=r("0e8f"),C=r("a722"),I=r("0fd9"),V=Object(h["a"])(m,u,v,!1,null,null,null),k=V.exports;g()(V,{VBtn:b["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VDialog:O["a"],VDivider:x["a"],VFlex:w["a"],VLayout:C["a"],VRow:I["a"]});var j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._l(6,(function(t){return r("v-row",{key:t.index,staticClass:"mx-auto"},[r("v-col",{attrs:{cols:"5"}},[r("v-sheet",{staticClass:"ml-5"},[r("v-skeleton-loader",{attrs:{t:t,type:"sentences"}})],1)],1),r("v-col",{attrs:{cols:"2"}}),r("v-col",{attrs:{cols:"5"}},[r("v-sheet",{staticClass:"mr-5"},[r("v-skeleton-loader",{staticClass:"mt-12",attrs:{type:"sentences"}})],1)],1)],1)})),1)},$=[],S=r("62ad"),D=r("8dd9"),q=r("3129"),z={},M=Object(h["a"])(z,j,$,!1,null,null,null),A=M.exports;function L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?L(r,!0).forEach((function(e){Object(n["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}g()(M,{VCol:S["a"],VRow:I["a"],VSheet:D["a"],VSkeletonLoader:q["a"]}),o["a"].use(d.a);var H={components:{appDetailQuotationModal:k,appMessageLoading:A},data:function(){return{base64:"",file:"",input:"",typing:!1,chat:{messages:[]},from:"",to:"",index:null,loading:!1,overlay:!1,isActive:!0,list:["ee","oo","fff","fffgg","ee","oo","fff","fffgg","ee","oo","fff","fffgg"]}},computed:P({},Object(l["c"])(["auth","currentOrder"])),methods:P({},Object(l["b"])(["fetchCurrentOrder"]),{sendMessage:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(this.input.length<=200&&0!==this.input.length||this.file)){t.next=24;break}return this.auth._id===this.currentOrder.employerId._id&&(this.from=this.currentOrder.employerId._id,this.to=this.currentOrder.freelancerId._id),this.auth._id===this.currentOrder.freelancerId._id&&(this.from=this.currentOrder.freelancerId._id,this.to=this.currentOrder.employerId._id),this.file&&(this.overlay=!0),this.file||this.chat.messages.push({message:this.input,from:this.from,to:this.to,orderId:this.currentOrder._id}),e=new FormData,e.append("message",this.input),e.append("from",this.from),e.append("to",this.to),e.append("orderId",this.currentOrder._id),e.append("portfolioId",this.currentOrder.portfolioId._id),e.append("image",this.file),this.input="",this.base64="",this.typing=!1,t.next=18,this.$axios.post("message/send",e);case 18:r=t.sent,s=r.data.messages,this.overlay=!1,this.file&&this.chat.messages.push(s),this.file="",this.$io.emit("message",s);case 24:t.next=29;break;case 26:throw t.prev=26,t.t0=t["catch"](0),new Error(t.t0);case 29:case"end":return t.stop()}}),t,this,[[0,26]])})));function e(){return t.apply(this,arguments)}return e}(),fetchMessage:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.$axios.get("message/user-message",{params:{orderId:this.$route.params.id}});case 3:e=t.sent,this.chat.messages=e.data.messages,setTimeout((function(){r.loading=!1}),200);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),imgUpload:function(t){var e=this,r=t.target.files[0],s=new FileReader;r["size"]<2e6?(s.onloadend=function(t){e.base64=t.target.result},s.readAsDataURL(r),this.file=r):this.$swal({title:"ຮູບພາບຂະໜາດໃຫຍ່ເກີນໄປ",toast:!0,type:"error",position:"top-end",showConfirmButton:!1,timer:2e3})}}),watch:{"$route.params":{handler:function(t){var e=t.id;this.fetchCurrentOrder(e),this.fetchMessage(e)},immediate:!0}},mounted:function(){var t=this;this.$io.on("message",(function(e){var r=e.orderId;r._id===t.currentOrder._id&&t.chat.messages.push(e)})),this.$io.on("update-message",(function(){return t.fetchMessage(t.currentOrder._id)}))}},R=H,E=(r("d06b"),r("34e0"),r("f38d"),r("8212")),F=r("4bd4"),T=r("132d"),N=r("adda"),U=r("f2e7"),B=r("90a2"),J=r("58df"),Y=r("80d2"),Q=Object(J["a"])(U["a"]).extend({name:"VLazy",directives:{intersect:B["a"]},props:{minHeight:[Number,String],options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},transition:{type:String,default:"fade-transition"}},computed:{styles(){return{minHeight:parseInt(this.minHeight)?Object(Y["f"])(this.minHeight):this.minHeight}}},methods:{genContent(){const t=Object(Y["p"])(this);if(!this.transition)return t;const e=[];return this.isActive&&e.push(t),this.$createElement("transition",{props:{name:this.transition}},e)},onObserve(t,e,r){this.isActive||(this.isActive=r)}},render(t){return t("div",{staticClass:"v-lazy",attrs:this.$attrs,directives:[{name:"intersect",value:{handler:this.onObserve,options:this.options}}],on:this.$listeners,style:this.styles},[this.genContent()])}}),W=r("a797"),G=r("490a"),K=r("2fa4"),X=r("8654"),Z=Object(h["a"])(R,s,a,!1,null,"13bbc3bc",null);e["default"]=Z.exports;g()(Z,{VAvatar:E["a"],VCard:_["a"],VCol:S["a"],VForm:F["a"],VIcon:T["a"],VImg:N["a"],VLazy:Q,VOverlay:W["a"],VProgressCircular:G["a"],VRow:I["a"],VSpacer:K["a"],VTextField:X["a"]})},"8a07":function(t,e,r){},d06b:function(t,e,r){"use strict";var s=r("3320"),a=r.n(s);a.a},ddea:function(t,e,r){},f38d:function(t,e,r){"use strict";var s=r("ddea"),a=r.n(s);a.a}}]);
//# sourceMappingURL=chunk-4f4935e0.5694b845.js.map