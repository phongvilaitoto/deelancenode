(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b1e1ef1"],{"123d":function(e,t,r){(function(t,r){e.exports=r()})(0,(function(){"use strict";var e=function(e,t){"function"===typeof e.scroll?e.scroll({top:e.scrollHeight,behavior:t?"smooth":"instant"}):e.scrollTop=e.scrollHeight},t={bind:function(t,r){var a=!1;t.addEventListener("scroll",(function(e){a=t.scrollTop+t.clientHeight+1<t.scrollHeight})),new MutationObserver((function(s){var i=r.value||{},n=!1===i.always&&a,o=s[s.length-1].addedNodes.length,l=s[s.length-1].removedNodes.length;if(i.scrollonremoved){if(n||1!=o&&1!=l)return}else if(n||1!=o)return;var c=i.smooth,d=!o&&1===l;d&&i.scrollonremoved&&"smoothonremoved"in i&&(c=i.smoothonremoved),e(t,c)})).observe(t,{childList:!0,subtree:!0})},inserted:function(t,r){var a=r.value||{};e(t,a.smooth)}},r={install:function(e,r){e.directive("chat-scroll",t)}};return"undefined"!==typeof window&&window.Vue&&window.Vue.use(r),r}))},"1f09":function(e,t,r){},3129:function(e,t,r){"use strict";r("1f09");var a=r("c995"),s=r("24b2"),i=r("7560"),n=r("58df"),o=r("80d2");t["a"]=Object(n["a"])(a["a"],s["a"],i["a"]).extend({name:"VSkeletonLoader",props:{boilerplate:Boolean,loading:Boolean,tile:Boolean,transition:String,type:String,types:{type:Object,default:()=>({})}},computed:{attrs(){return this.isLoading?this.boilerplate?{}:{"aria-busy":!0,"aria-live":"polite",role:"alert",...this.$attrs}:this.$attrs},classes(){return{"v-skeleton-loader--boilerplate":this.boilerplate,"v-skeleton-loader--is-loading":this.isLoading,"v-skeleton-loader--tile":this.tile,...this.themeClasses,...this.elevationClasses}},isLoading(){return Boolean(!Object(o["p"])(this)||this.loading)},rootTypes(){return{actions:"button@2",article:"heading, paragraph",avatar:"avatar",button:"button",card:"image, card-heading","card-avatar":"image, list-item-avatar","card-heading":"heading",chip:"chip","date-picker":"list-item, card-heading, divider, date-picker-options, date-picker-days, actions","date-picker-options":"text, avatar@2","date-picker-days":"avatar@28",heading:"heading",image:"image","list-item":"text","list-item-avatar":"avatar, text","list-item-two-line":"sentences","list-item-avatar-two-line":"avatar, sentences","list-item-three-line":"paragraph","list-item-avatar-three-line":"avatar, paragraph",paragraph:"text@3",sentences:"text@2",table:"table-heading, table-thead, table-tbody, table-tfoot","table-heading":"heading, text","table-thead":"heading@6","table-tbody":"table-row-divider@6","table-row-divider":"table-row, divider","table-row":"table-cell@6","table-cell":"text","table-tfoot":"text@2, avatar@2",text:"text",...this.types}}},methods:{genBone(e,t){return this.$createElement("div",{staticClass:`v-skeleton-loader__${e} v-skeleton-loader__bone`},t)},genBones(e){const[t,r]=e.split("@"),a=()=>this.genStructure(t);return Array.from({length:r}).map(a)},genStructure(e){let t=[];e=e||this.type||"";const r=this.rootTypes[e]||"";if(e===r);else{if(e.indexOf(",")>-1)return this.mapBones(e);if(e.indexOf("@")>-1)return this.genBones(e);r.indexOf(",")>-1?t=this.mapBones(r):r.indexOf("@")>-1?t=this.genBones(r):r&&t.push(this.genStructure(r))}return[this.genBone(e,t)]},genSkeleton(){const e=[],t=Object(o["p"])(this);return this.isLoading?e.push(this.genStructure()):e.push(t),this.transition?this.$createElement("transition",{props:{name:this.transition},on:{enter:e=>{this.isLoading&&(e.style.transition="none")},beforeLeave:e=>{e.style.display="none"}}},e):e},mapBones(e){return e.replace(/\s/g,"").split(",").map(this.genStructure)}},render(e){return e("div",{staticClass:"v-skeleton-loader",attrs:this.attrs,on:this.$listeners,class:this.classes,style:this.isLoading?this.measurableStyles:void 0},[this.genSkeleton()])}})},"4b23":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fixed",style:e.$vuetify.breakpoint.smAndDown?"height: calc(100vh - 110px)":""},[r("v-card",{staticClass:"pa-5",attrs:{outlined:"",tile:"",align:"left"}},[r("b",[e._v("OrderID: "+e._s(e.currentOrder.quotation.orderId))])]),e.loading?r("v-card",{staticClass:"body-fixed"},[r("app-message-loading")],1):r("v-card",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1},expression:"{ always: false }"}],staticClass:"body-fixed pa-2",attrs:{outlined:"",tile:""}},[e._l(e.chat.messages,(function(t,a){return r("div",{key:a},[t.from!==e.auth._id?r("div",{staticClass:"msg-box receive"},[r("div",{staticClass:"receive-msg"},[r("v-avatar",{attrs:{height:"48"}},[r("v-img",{attrs:{src:e.auth._id===e.currentOrder.freelancerId._id?e.$server+e.currentOrder.employerId.image:e.$server+e.currentOrder.freelancerId.image}})],1),t.image?r("p",[r("v-img",{attrs:{contain:"","max-width":"200",src:e.$server+t.image,"lazy-src":e.$server+t.image}}),r("v-spacer"),r("span",[e._v(e._s(t.message))])],1):t.message?r("p",[e._v(e._s(t.message))]):e._e(),"quotation"===t.type?r("p",[r("v-card",{staticClass:"pa-2"},[r("div",{staticClass:"mx-5 my-5"},[r("b",[e._v(" ໃບສະເໜີລາຄາ ")]),r("br"),r("small",{staticClass:"mb-5"},[e._v(" "+e._s(e.currentOrder.portfolioId.title))]),r("br"),r("b",[e._v("ລາຄາ")]),r("span",{staticClass:"primary--text"},[e._v(" "+e._s(t.orderId.quotation.price.toLocaleString())+" ")]),r("b",[e._v("ກີບ")]),r("app-detail-quotation-modal",{attrs:{auth:e.auth,order:t.orderId,currentOrder:e.currentOrder}})],1)])],1):e._e()],1)]):r("div",{staticClass:"msg-box send"},[r("div",{staticClass:"send-msg"},[t.image?r("p",[r("v-img",{attrs:{contain:"","max-width":"200",src:e.$server+t.image,"lazy-src":e.$server+t.image},on:{click:function(t){e.index=a}}}),r("span",[e._v(e._s(t.message))])],1):t.message?r("p",[e._v(e._s(t.message))]):e._e(),"quotation"===t.type?r("p",[r("v-card",{staticClass:"pa-2"},[r("div",{staticClass:"mx-5 my-5"},[r("b",[e._v(" ໃບສະເໜີລາຄາ ")]),r("br"),r("small",{staticClass:"mb-5"},[e._v(" "+e._s(e.currentOrder.portfolioId.title))]),r("br"),r("b",[e._v("ລາຄາ")]),r("span",{staticClass:"primary--text"},[e._v(" "+e._s(t.orderId.quotation.price.toLocaleString())+" ")]),r("b",[e._v("ກີບ")]),r("app-detail-quotation-modal",{attrs:{auth:e.auth,order:t.orderId,currentOrder:e.currentOrder}})],1)])],1):e._e()]),r("v-spacer")],1)])})),e.typing?r("div",{staticClass:"msg-box receive"},[r("div",{staticClass:"receive-msg"},[r("p",[e._v("ກໍາລັງພິມ...")])])]):e._e()],2),e.base64?r("v-card",{attrs:{outlined:"",tile:""}},[r("div",{staticClass:"text-left"},[r("v-img",{staticClass:"ma-1",staticStyle:{border:"1px solid white"},attrs:{contain:"","max-width":"100","max-height":"100",src:e.base64}},[r("v-icon",{staticClass:"error--text mb-2",staticStyle:{cursor:"pointer"},attrs:{size:"30"},on:{click:function(t){e.base64="",e.file=""}}},[e._v(" mdi-cancel")])],1)],1)]):e._e(),r("v-card",{attrs:{outlined:"",tile:""}},[r("v-card-actions",[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"text-right",attrs:{cols:"1",xs:"2",sm:"2",md:"1",lg:"1"}},[r("div",{staticClass:"mt-1 mr-11"},[r("a",{staticClass:"icon file-input",on:{click:e.sendMessage}},[r("label",{attrs:{for:"file"}},[r("v-icon",{attrs:{size:"42"}},[e._v("mdi-camera")])],1),r("input",{attrs:{type:"file",id:"file"},on:{change:e.imgUpload}})])])]),r("v-col",{staticClass:"text-center",attrs:{cols:"10",xs:"8",sm:"8",md:"10",lg:"10"}},[r("v-form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("v-text-field",{staticClass:"mx-1",attrs:{rounded:"","hide-details":"",solo:"",placeholder:"ພິມຂໍ້ຄວາມ..."},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)],1),r("v-col",{staticClass:"text-left",attrs:{cols:"1",xs:"2",sm:"2",md:"1",lg:"1"}},[r("div",{staticClass:"mt-1 mx-2"},[r("a",{staticClass:"icon",on:{click:e.sendMessage}},[r("v-icon",{attrs:{size:"42"}},[e._v("mdi-send")])],1)]),r("a",{staticClass:"icon file-input"})])],1)],1)],1)],1)},s=[],i=(r("a4d3"),r("4de4"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("96cf"),r("89ba")),n=r("2fa7"),o=r("2b0e"),l=r("123d"),c=r.n(l),d=r("2f62"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",{attrs:{justify:"center"}},[r("v-dialog",{attrs:{width:"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("a",e._g({staticClass:"primary--text ma-3"},a),[r("span",{staticStyle:{"text-decoration":"underline"}},[e._v("ລາຍລະອຽດໃບສະເໜີລາຄາ")])])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v("ລາຍລະອຽດໃບສະເໜີລາຄາ ")])]),r("v-card-text",[r("p",[r("b",[e._v("ວັນທີ່ ")]),e._v(e._s(e.$moment(e.order.quotation.createdAt).format("DD/MM/YY")))]),r("v-divider"),r("br"),r("p",[r("b",[e._v("orderID:")]),e._v(" "+e._s(e.order.quotation.orderId))]),r("v-layout",[r("v-flex",[r("p",[r("b",[e._v("ໃບສະເໜີລາຄາຂອງ")]),e._v(" "+e._s(e.currentOrder.freelancerId._id===e.order.freelancerId?e.currentOrder.freelancerId.username:e.currentOrder.employerId.username)+" ")])]),r("v-flex",[r("p",[r("b",[e._v("ຜູ້ວ່າຈ້າງ")]),e._v(" "+e._s(e.currentOrder.freelancerId._id===e.order.freelancerId?e.currentOrder.employerId.username:e.currentOrder.freelancerId.username)+" ")])])],1),r("v-card",[r("v-card-title",{staticClass:"primary white--text"},[e._v("ລາຍລະອຽດ")]),r("v-card-text",[r("br"),r("p",[e._v(e._s(e.currentOrder.portfolioId.title))]),r("p",[e._v(" - "+e._s(e.currentOrder.quotation.information))])]),r("v-divider"),r("v-card-actions",{staticClass:"white justify-end"},[r("span",{staticClass:"mx-2 my-2"},[r("b",[e._v("ລາຄາ: ")]),e._v(" "+e._s(Number(e.order.quotation.price.toFixed(1)).toLocaleString())+" "),r("b",[e._v("ກີບ ")])])])],1),r("br"),r("b",[e._v("ໃຊ້ເວລາເຮັດ:")]),r("p",[e._v(" "+e._s(e.order.quotation.dayWork)+" ມື້")]),r("b",[e._v("ສິ່ງທີ່ລູກຄ້າຈະໄດ້ຮັບ:")]),r("p",[e._v(e._s(e.order.quotation.receive))]),r("b",[e._v("ໝາຍເຫດ:")]),r("p",[e._v(e._s(e.order.quotation.optional))]),e.auth._id===e.order.employerId?r("div",[r("v-btn",{staticClass:"primary",attrs:{to:{name:"Payment",params:{id:e.order.quotation.orderId}},block:""}},[e._v(" ຊໍາລະເງິນ")]),r("small",[e._v("* ເມື່ອທ່ານຊໍາລະເງິນຜ່ານລະບົບແລ້ວ Freelance ຈະເລີ່ມເຮັດວຽກທັນທີ")])],1):r("div",[r("small",[e._v("* ລໍຖ້າຜູ້ວ່າຈ້າງຊໍາລະເງິນໃຫ້ລະບົບສໍາເລັດ ແລ້ວເລີ່ມເຮັດວຽກໄດ້ທັນທີ")])])],1)],1)],1)],1)},p=[],v={props:["auth","order","currentOrder"],data:function(){return{dialog:!1}}},h=v,m=r("2877"),f=r("6544"),g=r.n(f),b=r("8336"),_=r("b0af"),y=r("99d9"),x=r("169a"),O=r("ce7e"),w=r("0e8f"),C=r("a722"),k=r("0fd9"),I=Object(m["a"])(h,u,p,!1,null,null,null),V=I.exports;g()(I,{VBtn:b["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VDialog:x["a"],VDivider:O["a"],VFlex:w["a"],VLayout:C["a"],VRow:k["a"]});var $=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",e._l(3,(function(e){return r("v-row",{key:e.index,staticClass:"mx-auto ma-5"},[r("v-col",{attrs:{cols:"5"}},[r("v-sheet",{staticClass:"ml-5"},[r("v-skeleton-loader",{attrs:{t:e,type:"sentences"}})],1)],1),r("v-col",{attrs:{cols:"2"}}),r("v-col",{attrs:{cols:"5"}},[r("v-sheet",{staticClass:"mr-5"},[r("v-skeleton-loader",{staticClass:"mt-12",attrs:{type:"sentences"}})],1)],1)],1)})),1)},j=[],S=r("62ad"),L=r("8dd9"),q=r("3129"),D={},B=Object(m["a"])(D,$,j,!1,null,null,null),M=B.exports;function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(r,!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}g()(B,{VCol:S["a"],VRow:k["a"],VSheet:L["a"],VSkeletonLoader:q["a"]}),o["a"].use(c.a);var R={components:{appDetailQuotationModal:V,appMessageLoading:M},data:function(){return{base64:"",file:"",input:"",typing:!1,chat:{messages:[]},from:"",to:"",index:null,loading:!1}},computed:P({},Object(d["c"])(["auth","currentOrder"])),methods:P({},Object(d["b"])(["fetchCurrentOrder"]),{sendMessage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!(this.input.length<=200&&0!==this.input.length||this.file)){e.next=20;break}return this.auth._id===this.currentOrder.employerId._id&&(this.from=this.currentOrder.employerId._id,this.to=this.currentOrder.freelancerId._id),this.auth._id===this.currentOrder.freelancerId._id&&(this.from=this.currentOrder.freelancerId._id,this.to=this.currentOrder.employerId._id),t=new FormData,t.append("message",this.input),t.append("from",this.from),t.append("to",this.to),t.append("orderId",this.currentOrder._id),t.append("image",this.file),this.input="",this.file="",this.base64="",this.typing=!1,e.next=16,this.$axios.post("message/send",t);case 16:r=e.sent,a=r.data.messages,this.chat.messages.push(a),this.$io.emit("message",a);case 20:e.next=25;break;case 22:throw e.prev=22,e.t0=e["catch"](0),new Error(e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])})));function t(){return e.apply(this,arguments)}return t}(),fetchMessage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$axios.get("message/user-message",{params:{orderId:this.$route.params.id}});case 3:t=e.sent,this.chat.messages=t.data.messages,setTimeout((function(){r.loading=!1}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),imgUpload:function(e){var t=this,r=e.target.files[0],a=new FileReader;r["size"]<2e6?(a.onloadend=function(e){t.base64=e.target.result},a.readAsDataURL(r),this.file=r):this.$swal({title:"ຮູບພາບຂະໜາດໃຫຍ່ເກີນໄປ",toast:!0,type:"error",position:"top-end",showConfirmButton:!1,timer:2e3})}}),watch:{"$route.params":{handler:function(e){var t=e.id;this.fetchCurrentOrder(t),this.fetchMessage(t)},immediate:!0}},mounted:function(){var e=this;this.$io.on("message",(function(t){var r=t.orderId;r._id===e.currentOrder._id&&e.chat.messages.push(t)})),this.$io.on("update-message",(function(){return e.fetchMessage(e.currentOrder._id)}))}},T=R,A=(r("b8aa"),r("4beb"),r("8212")),F=r("4bd4"),z=r("132d"),H=r("adda"),N=r("2fa4"),U=r("8654"),J=Object(m["a"])(T,a,s,!1,null,"5ff56eaf",null);t["default"]=J.exports;g()(J,{VAvatar:A["a"],VCard:_["a"],VCardActions:y["a"],VCol:S["a"],VForm:F["a"],VIcon:z["a"],VImg:H["a"],VRow:k["a"],VSpacer:N["a"],VTextField:U["a"]})},"4beb":function(e,t,r){"use strict";var a=r("4c3f"),s=r.n(a);s.a},"4c3f":function(e,t,r){},b8aa:function(e,t,r){"use strict";var a=r("f54a"),s=r.n(a);s.a},f54a:function(e,t,r){}}]);
//# sourceMappingURL=chunk-2b1e1ef1.aeb44a00.js.map